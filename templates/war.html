{% extends "base.html" %}
<head>
    <link rel="stylesheet" type="text/css" href="war.css" media=”screen” />
        {% block content %}
        <title>{%block title %}{{war_title[0]}} Scoreboard{% endblock %}</title>
        <meta name="title" content="{{war_title[0]}} Scoreboard">
        <meta name="description" content="View the scoreboard for {{war_title[0]}}">
        <meta property="og:type" content="website">
        <meta property="og:title" content="{{war_title[0]}} Scoreboard" />
        <meta property="og:description" content="View the scoreboard for {{war_title[0]}}" />
        <meta property="og:url" content="www.nw-stats.com/war/{{war_link}}" />
        <meta property="og:image" content="https://www.nw-stats.com/static/images/tuna_logo.png" />
</head>




    <style>

		table {
			border:2px #a6c9d9;
			border-collapse:separate;
			padding: 2px;
            margin-left: auto;
            margin-right: auto;
            width: 100%;

		}
		table th {
			border:2px #a6c9d9;
			padding: 5px;
			background: #000000;
			color: #fff;
			font-size: 24px;
            position: sticky;
            top: 0;
		}
		table td {
			border:2px #a6c9d9;
			text-align:center;
			padding: 8px;
			color: {{user_settings[6]}};
			font-size: 20px;
		}
		body{
		    font-family: Helvetica
		}

		a{
		    text-decoration: none;
		    color: {{user_settings[6]}};
		    font-style: bold;
		}

		a:hover{
		    color: white;
            font-size: 22px;
		}

		th a{
            color: white;
		}
		th a:hover{
		    color:gray;
		    font-size: 20px;
		}

        h3{
            text-align: center;

        }
        #header-fixed {
        position: fixed;
        top: 0px; display:none;
        }




#myBtn {
  display: none; /* Hidden by default */
  position: fixed; /* Fixed/sticky position */
  bottom: 20px; /* Place the button at the bottom of the page */
  right: 60px; /* Place the button 30px from the right */
  z-index: 99; /* Make sure it does not overlap */
  border: none; /* Remove borders */
  outline: none; /* Remove outline */
  background-color: {{user_settings[2]}}; /* Set a background color */
  color: white; /* Text color */
  cursor: pointer; /* Add a mouse pointer on hover */
  padding: 15px; /* Some padding */
  border-radius: 10px; /* Rounded corners */
  font-size: 24px; /* Increase font size */
}
#myBtn2 {
  display: none; /* Hidden by default */
  position: fixed; /* Fixed/sticky position */
  bottom: 20px; /* Place the button at the bottom of the page */
  left: 60px; /* Place the button 30px from the right */
  z-index: 99; /* Make sure it does not overlap */
  border: none; /* Remove borders */
  outline: none; /* Remove outline */
  background-color: {{user_settings[2]}}; /* Set a background color */
  color: white; /* Text color */
  cursor: pointer; /* Add a mouse pointer on hover */
  padding: 15px; /* Some padding */
  border-radius: 10px; /* Rounded corners */
  font-size: 24px; /* Increase font size */
}

#myBtn:hover {
  background-color: white; /* Add a dark-grey background on hover */
  color: black;
}
.flex-container {
    display: flex;
    background-image: linear-gradient(to right, {{user_settings[5]}} , {{user_settings[4]}});
}

.flex-child {
    flex: 1;

}






	</style>

	<body>
	    <button onclick="topFunction()" id="myBtn" title="Go to top">Back To Top</button>
	    <a href="#vods"><button id="myBtn2" title="Go to vods">Go To VODs</button></a>

    {% if has_ads == True %}
    {% endif %}

    <h1 style="color: white; border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: {{user_settings[2]}}; text-align: center; padding-bottom: .5%; margin-top: 2%; width: 80%; margin-left: 10%; font-size: 38px;">{{war_title[0]}} ({{war_title[1]}})</h1>
    <p style="color: white; font-size: 20px; width: 80%; border-bottom-color: {{user_settings[2]}}; text-align: center; padding-bottom: .5%; margin-top: 2%; width: 80%; margin-left: 10%;"> War stats from {{war_title[0]}} are below.<br><br> Click the table headings to sort by specific statistics | Click on player names to veiw their individual profile and statistics. <br><br>If you notice something wrong with these stats, please reach out via discord by clicking the "Report an Error" button.</p>
	<div style="width: 50%; margin-left: 25%; text-align: center; padding-bottom: 20px;">
	<a href="https://www.nw-stats.com/{{server}}"><button class="myButton" style="color: white; padding: 5px; display: inline-block; margin-right: 20px;"><h3 style="color: white;">Return To War List</h3></button></a>
	<a href="https://discord.gg/zCcMDbXvEs" target="_blank"><button class="myButton" style="color: white; padding: 5px; display: inline-block; margin-right: 20px;"><h3 style="color: white;">Report an Error</h3></button></a>
	<a href="https://www.nw-stats.com/{{server}}/war/{{war_id}}/submit_clip" target="_blank"><button class="myButton" style="color: white; padding: 5px; display: inline-block;"><h3 style="color: white;">Submit A Recording, Clip, or Vod</h3></button></a>
    </div>

        {% if info[3] == "Attack" and war_title[2] == "N/A"%}
            <h2 style="color:{{user_settings[6]}}; text-align: center; background-image: linear-gradient(to right, {{user_settings[5]}} , {{user_settings[4]}}); padding-top: 1%; padding-bottom: 1%; font-size: 36px;">Attackers Win!</h2>
        {% elif info[3] == "Attack" and war_title[2] != "N/A" %}
            <h2 style="color:{{user_settings[6]}}; text-align: center; background-image: linear-gradient(to right, {{user_settings[5]}} , {{user_settings[4]}}); padding-top: 1%; padding-bottom: 1%; font-size: 36px;">{{war_title[2]}} Victory!</h2>
        {% endif %}
        {% if info[3] == "Defense" and war_title[3] == "N/A" %}
            <h2 style="color:{{user_settings[6]}}; text-align: center; background-image: linear-gradient(to right, {{user_settings[5]}} , {{user_settings[4]}}); padding-top: 1%; padding-bottom: 1%; font-size: 36px;">Defenders Win!</h2>
        {% elif info[3] == "Defense" and war_title[3] != "N/A" %}
            <h2 style="color:{{user_settings[6]}}; text-align: center; background-image: linear-gradient(to right, {{user_settings[5]}} , {{user_settings[4]}}); padding-top: 1%; padding-bottom: 1%; font-size: 36px;">{{war_title[3]}} Victory!</h2>
        {% endif %}

        <div class="flex-container">

        <div class="flex-child attacker-logo" style="text-align:center; padding-top: 1%; padding-bottom: 1%;">
            <img style="text-align:right" src="/static/images/damage_icon.png" width = 200 height = 200></img>
            {% if war_title[2] == "N/A" %}
            <h2 style="color: {{user_settings[6]}}; font-size: 28px;">Attackers</h2>
            {% elif war_title[2] != "N/A" %}
            <h2 style="color: {{user_settings[6]}}; font-size: 28px;">{{war_title[2]}}</h2>
            {% endif %}
        </div>

          <div class="flex-child attacker" style="padding-top: 1%;">
            <h2 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; text-decoration: underline; font-size:34;">Attackers Totals</h2>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[4])}} Damage</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[6])}} Healing</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[8])}} Kills</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[10])}} Deaths</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[12])}} Assists</h3>

            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[14])}} Dmg/Kill</h3>


          </div>




          <div class="flex-child defender" style="padding-top: 1%;">
            <h2 style="color:{{user_settings[6]}}; text-align:center; padding-left:10px; text-decoration: underline; font-size:34;">Defenders Totals</h2>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-left:10px;font-size:30;">{{"{:,}".format(info[5])}} Damage</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-left:10px;font-size:30;">{{"{:,}".format(info[7])}} Healing</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-left:10px;font-size:30;">{{"{:,}".format(info[9])}} Kills</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-left:10px;font-size:30;">{{"{:,}".format(info[11])}} Deaths</h3>
            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-left:10px;font-size:30;">{{"{:,}".format(info[13])}} Assists</h3>

            <h3 style="color:{{user_settings[6]}}; text-align:center; padding-right:10px; font-size:30;">{{"{:,}".format(info[15])}} Dmg/Kill</h3>

          </div>

        <div class="flex-child defender-logo" style="text-align:center; padding-top: 1%; padding-bottom: 1%;">
            <img style="text-align:left" src="/static/images/tank_icon.png" width = 200 height = 200></img>
            {% if war_title[3] == "N/A" %}
            <h2 style="color: {{user_settings[6]}}; font-size: 28px;">Defenders</h2>
            {% elif war_title[3] != "N/A" %}
            <h2 style="color: {{user_settings[6]}}; font-size: 28px;">{{war_title[3]}}</h2>
            {% endif %}
          </div>
        </div>
    <table id="header-fixed">
    {% if sorted_by == "none" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}">Rank*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}">Rank</a></th>
        {% endif %}
        <th>Player Name</th>
        <th>Score</th>
        {% if sorted_by == "kills" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kills">Kills*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kills">Kills</a></th>
        {% endif %}
        {% if sorted_by == "deaths" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/deaths">Deaths*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/deaths">Deaths</a></th>
        {% endif %}
        {% if sorted_by == "assists" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/assists">Assists*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/assists">Assists</a></th>
        {% endif %}
        {% if sorted_by == "healing" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/healing">Healing*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}war/{{war_link}}/healing">Healing</a></th>
        {% endif %}
        {% if sorted_by == "damage" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/damage">Damage*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/damage">Damage</a></th>
        {% endif %}
        {% if sorted_by == "kpar" %}
        <th title="Kill participation (kills + assists)/ total enemy deaths"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kpar">Kpar %*</a></th>
        {% else %}
        <th title="Kill participation (kills + assists)/ total enemy deaths"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kpar">Kpar %</a></th>
        {% endif %}
        {% if sorted_by == "dmgkpar" %}
        <th title="Damage per kill (Total player damage)/(kills + assists)"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/dmgkpar">Damage Kpar*</a></th>
        {% else %}
        <th title="Damage per kill (Total player damage)/(kills + assists)"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/dmgkpar">Damage Kpar</a></th>
        {% endif %}
        {% if sorted_by == "role" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/role">Role*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/role">Role</a></th>
        {% endif %}
        {% if sorted_by == "team" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/team">Team*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/team">Team</a></th>
        {% endif %}
        </table>
    <table id="table-1" style="padding-top:15px">

        {% if sorted_by == "none" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}">Rank*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}">Rank</a></th>
        {% endif %}
        <th>Player Name</th>
        <th>Score</th>
        {% if sorted_by == "kills" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kills">Kills*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kills">Kills</a></th>
        {% endif %}
        {% if sorted_by == "deaths" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/deaths">Deaths*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/deaths">Deaths</a></th>
        {% endif %}
        {% if sorted_by == "assists" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/assists">Assists*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/assists">Assists</a></th>
        {% endif %}
        {% if sorted_by == "healing" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/healing">Healing*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/healing">Healing</a></th>
        {% endif %}
        {% if sorted_by == "damage" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/damage">Damage*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/damage">Damage</a></th>
        {% endif %}
        {% if sorted_by == "kpar" %}
        <th title="Kill participation (kills + assists)/ total enemy deaths"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kpar">Kpar %*</a></th>
        {% else %}
        <th title="Kill participation (kills + assists)/ total enemy deaths"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/kpar">Kpar %</a></th>
        {% endif %}
        {% if sorted_by == "dmgkpar" %}
        <th title="Damage per kill (Total player damage)/(kills + assists)"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/dmgkpar">Damage Kpar*</a></th>
        {% else %}
        <th title="Damage per kill (Total player damage)/(kills + assists)"><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/dmgkpar">Damage Kpar</a></th>
        {% endif %}
        {% if sorted_by == "role" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/role">Role*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/role">Role</a></th>
        {% endif %}
        {% if sorted_by == "team" %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/team">Team*</a></th>
        {% else %}
        <th><a href="https://www.nw-stats.com/{{server}}/war/{{war_link}}/team">Team</a></th>
        {% endif %}
    {% for item in info[0][0] %}
        {% if item[13] == "Defense" %}
    <tr style="background-color: {{user_settings[4]}}">

        <td><b>{{item[1]}}</b></td>
        {% if user_settings[8].__contains__(item[2]) and session['discord_id'] == user_settings[0] %}
        <td><b><a href="https://www.nw-stats.com/{{server}}/player/{{item[2]}}">{{item[2]}}  </b></a><img style="text-align:right" src="/static/images/tank_icon.png" width = 32 height = 32></img><a href="https://www.nw-stats.com/{{server}}/update_role/{{user_settings[8]}}/{{item[9]}}"><button class="myButton" style="color: {{user_settings[6]}}; text-align: center; width: auto; margin-left:15px;">Set Role</button></td>
        {% else %}
        <td><b><a href="https://www.nw-stats.com/{{server}}/player/{{item[2]}}">{{item[2]}}  </b></a><img style="text-align:right" src="/static/images/tank_icon.png" width = 32 height = 32></img></a></td>
        {% endif %}
        <td>{{"{:,}".format(item[3].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[4].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[5].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[6].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[7].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[8].replace("*","")|int)}}</td>
        <td>{{item[11]}}%</td>
        <td>{{"{:,}".format(item[12].replace("*","")|int)}}</td>
        <td>{{item[15]}}</td>
        <td>{{item[13]}}</td>
    </tr>
        {% endif %}

        {% if item[13] == "Attack" %}
        <tr style="background-color:{{user_settings[5]}}">
        <td><b>{{item[1]}}</b></td>
        {% if user_settings[8].__contains__(item[2]) and session['discord_id'] == user_settings[0] %}
        <td><b><a href="https://www.nw-stats.com/{{server}}/player/{{item[2]}}">{{item[2]}}  </b></a><img style="text-align:right" src="/static/images/damage_icon.png" width = 32 height = 32></img><a href="https://www.nw-stats.com/{{server}}/update_role/{{user_settings[8]}}/{{item[9]}}"><button class="myButton" style="color: {{user_settings[6]}}; text-align: center; width: auto; margin-left:15px;">Set Role</button></td>
        {% else %}
        <td><b><a href="https://www.nw-stats.com/{{server}}/player/{{item[2]}}">{{item[2]}}  </b></a><img style="text-align:right" src="/static/images/damage_icon.png" width = 32 height = 32></img></a></td>
</td>
        {% endif %}
        <td>{{"{:,}".format(item[3].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[4].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[5].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[6].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[7].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[8].replace("*","")|int)}}</td>
        <td>{{item[11]}}%</td>
        <td>{{"{:,}".format(item[12].replace("*","")|int)}}</td>
        <td>{{item[15]}}</td>
        <td>{{item[13]}}</td>
    </tr>
        {% endif %}
            {% if item[13] == "N/A" %}
            <tr>
        <td><b>{{item[1]}}</b></td>
        <td><b><a href="https://www.nw-stats.com/player/{{item[2]}}">{{item[2]}}  </b></a></td>
        <td>{{"{:,}".format(item[3].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[4].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[5].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[6].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[7].replace("*","")|int)}}</td>
        <td>{{"{:,}".format(item[8].replace("*","")|int)}}</td>
        <td>{{item[11]}}%</td>
        <td>{{"{:,}".format(item[12].replace("*","")|int)}}</td>
        <td>{{item[15]}}</td>
        <td>{{item[13]}}</td>
    </tr>
        {% endif %}
    {% endfor %}
    </table>
    <H3 style="color: white;">* = Player reportedly had connection issues during war, and stats for these players are not calculated into overall performance values.</H3>
    <H3 style="color: white;">** = War was very short duration or very one sided. These Stats are not included in stat calculation.</H3>


<div class="chartcontainer" style="width: 90%;">
<div class="grid" style="width: 100%; background-color: white; display: inline-block; margin-left: 5%; text-align: center;">
<div style= "max-width: 50%; display: inline-block; text-align: center;"><embed>{{info[1]|safe}}</embed></div>
<div style="max-width: 50%; display: inline-block; text-align: center;"><embed>{{info[2]|safe}}</embed></div>
</div>
</div>
<script>
//Get the button:
mybutton = document.getElementById("myBtn");
mybutton2 = document.getElementById("myBtn2");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
    mybutton.style.display = "block";
    mybutton2.style.display = "block";
  } else {
    mybutton.style.display = "none";
    mybutton2.style.display = "block";

  }
}
var tableOffset = $("#table-1").offset().top;
var $header = $("#table-1 > thead").clone();
var $fixedHeader = $("#header-fixed").append($header);

$(window).bind("scroll", function() {
    var offset = $(this).scrollTop();

    if (offset >= tableOffset && $fixedHeader.is(":hidden")) {
        $fixedHeader.show();
    }
    else if (offset < tableOffset) {
        $fixedHeader.hide();
    }
});
// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0; // For Safari
  document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
</script>
</body>

<div align="center" style="padding-top: 15px;">
    <h2 id="vods" style="color: white;">Watch Twitch Clips From This War</h2>
{% for vod in vods[0] %}
<iframe style="text-align: center"
    src="https://clips.twitch.tv/embed?clip={{vod[1]}}&parent=www.nw-stats.com"
    height="200"
    width="300"
    allowfullscreen>
</iframe>
{% if vod[2] %}
<p style="text-align:center; color:white">{{vod[2]}}</p>
{% endif %}
{% endfor %}
{% for vod in vods[1] %}
<iframe style="text-align: center"
    src="https://player.twitch.tv/?video=v{{vod[1]}}&parent=www.nw-stats.com&autoplay=false"
    height="200"
    width="300"
    allowfullscreen>
</iframe>
{% if vod[2] %}
<p style="text-align:center; color:white">{{vod[2]}}</p>
{% endif %}
{% endfor %}
{% for vod in vods[2] %}
<iframe style="text-align: center"
    src="https://www.youtube.com/embed/{{vod[1]}}"
    height="200"
    width="300"
    allowfullscreen>
</iframe>
{% if vod[2] %}
<p style="text-align:center; color:white">{{vod[2]}}</p>
{% endif %}
{% endfor %}
</div>

{% endblock %}
